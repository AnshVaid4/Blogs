---
title: NBTNS-LLMNR Poisoning
author: Ansh Vaid
date: 2021-04-13 7:10:00 +0530
categories: [Cyber Security and Ethical Hacking]
tags: [CEH, EthicalHacking, CyberSecurity , attack, NBTNS-LLMNR, poisoning, nbtns, llmnr, john the ripper, john, hash, LAN]
---

<img src="/assets/EthicalHacking/responderbanner.PNG" alt="image1" height="400" width="900"/>
<caption>Image taken from <a href="https://blog.ipleaders.in/wp-content/uploads/2020/02/Ways-Websites-Are-Hacked-How-to-Prevent-Them-1-696x333.png">here</a></caption>

---

In this blog I am going to show an another attack which is very prominent in the Local Area Network. This attack is called **NBTNS-LLMNR Poisoning**. As we know that NBTNS i.e. the netbios name service and the link-local multicast name resolution are the two services which help in the file transfer among the Windows OS in a local network. I will show how this can be done and what can be done to mitigate it.

# <u>What This Service Actually Does?</u>
The two services NBTNS and LLMNR help in the name resolution of the devices connected in a network in order to transfer the files. We do have seen the shared folders in our Windows OS somewhere. So these shared folder are accessible from other Windows OS as well, but to access that, the nbtns service runs to create a connection with other host. Just like DNS does, the same task is done by NBTNS and LLMNR but for the local level to know the host and connect it.

# <u>What is NBTNS-LLMNR Poisoning?</u>
The attcker gets connected to the network to listen the broadcast packets from nbtns and llmnr service and respond it. Let's see the case.
<br>
<br>

1. A local network is there where the shared resources such as printers along with some computers. Each device has its own device name. And the local DNS of LAN has the entries of the device names mapped with respective IP addresses.
<br>


2. Now some device wants to print the document, so it will we typing the name of device or IP to connect it and use the printer.
<br>


3. When the name of device is entered it is sent to DNS, if it is present there then redirected to the correct device, if entry is not present then the request is broadcasted to know which device name is it.
<br>


4. The attacker gets the request and responds it by saying that "yes it is me". Ultimately the victim machine gets to know that the device is up and now it sends its username and hashes to the attacker unknown from the fact that it is an attacker.
<br>


5. This is the whole concept og poisoning and how does the attacker gets the hashes.
<br>
<br>
<br>

# <u>How It Can Be Done?</u>
The attack is done in a Local Area Network. Where the attacker has to respond the request generated by the devices connected there. Following are the steps that can be performed to do so:
<br>

<ol>
<li> You need one Windows OS device.</li><br>
<li> Kali being the attacker machine. Make sure they are in bridged connection.<br><br>

<img src="/assets/EthicalHacking/responder1.PNG">
</li>
<br><br>

<li> Open terminal and start <b>Responder</b> by entering <b>responder -I [Network Interface Name like eth0]</b>.<br><br>

<img src="/assets/EthicalHacking/responder2.PNG">
<img src="/assets/EthicalHacking/responder3.PNG">
</li>
<br><br>
<li> The responder will start at the specified interface.</li><br>
<li> In Windows OS, use the <i>hotkey</i>  <b>windows+R</b>.</li><br>
<li> The Run dialogue box will be prompted.</li><br>
<li> Now type there <b>\\[any IP ID]</b> OR <b>\\[any string]</b> and press enter key.<br><br>

<img src="/assets/EthicalHacking/responder4.PNG">
</li>
<br><br>

<li> As soon as it is done, the local DNS will get the request to connect to the string name or the IP address, but it will unable to redirect because the intry is not present in DNS, so it will be broadcasted, to know wihich IP or device name is it.</li><br>
<li>  The responder running in the kali machine will respond now, and now the hashes of the user and the device name will be captured by the responder.<br><br>


<img src="/assets/EthicalHacking/responder5.PNG">
</li>
<br><br>

<li>  Now you can crack the hashes with <b>John the ripper</b> as I have shown in <a href="https://blog.vulnfreak.org/posts/PasswordCrack/">https://blog.vulnfreak.org/posts/PasswordCrack</a> blog. </li><br>
<li>  You can also find the hashes in the <i>/usr/share/responder/logs/[IP address.txt]</i> file that you got above.</li>
</ol>
<br><br>

*In this way the NBTNS-LLMNR Poisoning attack takes place in a Local Area Network. You can easily get the victim's device name, IP address, username, password hash from this attack. To mitigate this attack you should turn of the services when not in use, and avoid the shared resources in a network.*